@model OBM.Models.ViewModels.TournamentViewModel
@{
    ViewBag.Title = Model.TournamentName;
    ViewBag.ApiID = Model.ApiId;
    ViewBag.TourneyID = Model.TournamentID;

    <h1>@Html.DisplayFor(model => model.TournamentName)</h1>

    if (ViewBag.Access == true)
    {

<div>
    <hr />
    <dl class="dl-horizontal">
        <dt>Description</dt>
        <dd>@Html.DisplayFor(model => model.Description)</dd>

        <dt>Game</dt>
        <dd>@Html.DisplayFor(model => model.Game)</dd>

        <dt>Team Based?</dt>
        <dd>@Html.DisplayFor(model => model.IsTeams)</dd>

        <dt>Event</dt>
        <dd>@Html.ActionLink(Model.EventName.ToString(), "/Details/" + Model.EventID)</dd>

        <dt>Tournament Organizer</dt>
        <dd>@Html.DisplayFor(model => model.OrganizerName)</dd>

        <dt>Challonge URL:</dt>
        <dd><a href="https://challonge.com/@Html.DisplayFor(model => model.UrlString)">https://challonge.com/@Html.DisplayFor(model => model.UrlString)</a></dd>

    </dl>
    @if (Model.IsStarted == "No")
    {
        <p>@TempData["Result"]</p>
        <dl class="dl-horizontal">
            @using (Html.BeginForm("AddSingleParticipant", "Competitor", FormMethod.Post))
            {

                <dt>Add Participants:</dt>
                <dd>
                    <select name="options" id="options">
                        <option>
                            -Select Method-
                        </option>
                        <option value="Single">
                            Single Participant
                        </option>
                        <option value="Bulk">
                            Bulk Participants
                        </option>
                        <option value="CSV">
                            CSV file
                        </option>
                    </select>
                    <br />

                    <div class="Single add" id="participantOptions">
                        <label for="create">Participant's Name or Gamer Tag: </label>
                        <br />
                        <input type="text" name="singleAdd" />
                        <input type="submit" value="Add" class="btn createbtn" />
                        <input type="hidden" name="ApiID" value="@ViewBag.ApiID" />
                        <input type="hidden" name="TourneyID" value="@ViewBag.TourneyID" />
                    </div>
                </dd>
            }

        </dl>

        <dl class="dl-horizontal">
            @using (Html.BeginForm("BulkAddParticipants", "Competitor", FormMethod.Post))
            {
                <dt></dt>
                <dd>
                    <div class="Bulk add" id="participantOptions">
                        <div>
                            <i>Format input like; participant,participant,...</i>
                        </div>
                        <label for="bulkadd">Bulk add Participants:</label>
                        <br />
                        <input type="text" name="bulkadd" />
                        <input type="submit" value="Bulk Add" class="btn createbtn" />
                        <input type="hidden" name="ApiID" value="@ViewBag.ApiID" />
                        <input type="hidden" name="TourneyID" value="@ViewBag.TourneyID" />
                    </div>
                </dd>
            }
        </dl>

        <dl class="dl-horizontal">
            @using (Html.BeginForm("BulkAddParticipants", "Competitor", FormMethod.Post))
            {
                <dt></dt>
                <dd>
                    <div class="CSV" id="participantOptions">
                        <div>
                            <i>upload a .CSV file with each participant alone on each line</i>
                        </div>
                        <label for="bulkadd">Bulk add Participants:</label>
                        <br />
                        <input type="hidden" name="bulkadd" id="bulkadd" />

                        <input type="file" name="CSV" accept=".csv" id="CSV" />
                        <input type="submit" value="Submit" class="btn createbtn" />
                        <input type="hidden" name="ApiID" value="@ViewBag.ApiID" />
                        <input type="hidden" name="TourneyID" value="@ViewBag.TourneyID" />
                        <br />


                    </div>
                    <div id="participantsParsedList"></div>
                </dd>

            }
        </dl>

        <button type="button" onclick="hideShow('seed-div');">Seed</button>
        <br />
        <div id="seed-div" class="container card border-success" style="display:none">
            <div class="row card-body">
                <ul class="nav nav-pills nav-stacked col col-lg-2">
                    <li class="nav-item"><a id="select" class="nav-link active" href="#tab_a" data-toggle="pill">Select Competitors</a></li>
                    <li class="nav-item"><a id="rank" class="nav-link" href="#tab_b" data-toggle="pill">Rank Selected</a></li>
                    <li class="nav-item"><a id="group" class="nav-link" href="#tab_c" data-toggle="pill">Additional Seeding</a></li>
                    <li><button type="button" id="saveBtn" onclick="saveSeed()" class="btn btn-success">Save Seed</button></li>
                    <li><p>@ViewBag.keyCheck</p></li>
                    <li><p>@ViewBag.Success</p></li>
                </ul>
                <div class="tab-content col">
                    <div class="tab-pane active" id="tab_a">
                        <p>Select all the competitors you want seed</p>
                        <ul id="selectable-rank" class="ui-selectable">
                            @foreach (var comp in Model.CompetitorList)
                            {
                                <li>@comp</li>
                            }
                        </ul>
                    </div>
                    <div class="tab-pane" id="tab_b">
                        <div class="col">
                            <p>Assign the desired seed to all selected competitors</p>
                            <ol id="sortable-1" class="ui-sortable">
                                <lh></lh>
                            </ol>
                        </div>
                    </div>
                    <div class="tab-pane" id="tab_c">
                        <p>Add competitors to the same group to evenly distribute there seeds</p>
                        <div class="row">
                            <div class="col card bg-light">
                                <ul id="sortable-2" class="ui-sortable sortable">
                                    <li class="hide">bottom</li>
                                    @foreach (var comp in Model.CompetitorList)
                                    {
                                        <li>@comp</li>
                                    }
                                </ul>
                            </div>
                            <div class="col">
                                <div id="groups">
                                </div>
                                <a onclick="addGroup()">Add Group</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
        <br />

        <table class="table table-bordered table-striped">
            <tr>
                <th>Brackets</th>
            </tr>

        </table>
        <table class="table table-bordered table-striped">
            <tr>
                <th>Competitors</th>
            </tr>
        </table>
    </div>

        <input id="EventID" type="hidden" value="@Model.EventID" />
        <input id="TournamentID" type="hidden" value="@Model.TournamentID" />
        <input id="UrlString" type="hidden" value="@Model.UrlString" />

        <button type="button" onclick="hideShow('MinimalGraph');">Show Time Line</button>
        <div id="MinimalGraph" style="display:block">
            <canvas id="myChart"></canvas>
        </div>

        using (Html.BeginForm(FormMethod.Post))
        {
            <div class="form-group">
                <input id="delete-tournament" type="submit" value="Delete Tournament" class="btn btn-danger" />
            </div>
        }
        <div>
            @Html.ActionLink("Back to Event", "Manage", "Events", routeValues: new { id = Model.EventID }, htmlAttributes: new { @class = "btn registerbtn" })
        </div>
    }
    else
    {
        <div class="form-horizontal">
            <h4>Access Denied</h4>
        </div>
    }


    @section scripts
    {
        <script type="text/javascript" src="~/Scripts/participants.js"></script>
    }
}

@Scripts.Render("~/bundles/TournamentDisplay")
